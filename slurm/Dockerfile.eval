FROM vllm/vllm-openai:latest

# Configure project dir
ARG PROJECT_DIR=/workspace
ENV PROJECT_DIR="${PROJECT_DIR}"

# Create lib to download lmms-eval
RUN mkdir -p /lib/eval

# Copy submodule
COPY ./eval/ /lib/eval/

# Install ./eval as a package
RUN pip install /lib/eval/

# Set working directory
WORKDIR ${PROJECT_DIR}

# Caches inside mounted directory
ENV HF_HOME="${PROJECT_DIR}/.hf"

ENTRYPOINT ["/bin/bash"]
CMD ["-l"]
